var playButton = document.getElementById("playButton");
var answerButton = document.getElementById("answerButton");
var questionDiv = document.getElementById("question");
var remainingDiv = document.getElementById("remaining");
var correctDiv = document.getElementById("correct");

var questions = [];
var currentQuestionIndex = -1;
var correctAnswers = 0;
const NumberOfQuestions = 10;

function DisplayCurrentQuestion()
{
  questionDiv.innerHTML = "<p>" + questions[currentQuestionIndex].question + "</p>";
  questionDiv.innerHTML += "<input type=\"radio\" name=\"answer\" value=\"True\" /> True";
  questionDiv.innerHTML += "<input type=\"radio\" name=\"answer\" value=\"False\" /> False";
}

function ResetGame()
{
    currentQuestionIndex = -1;
    correctAnswers = 0;
    questions = [];
    remainingDiv.innerText = "";
    correctDiv.innerText = "";

    fetch('https://opentdb.com/api.php?type=boolean&amount=' + NumberOfQuestions)
    .then(response => response.json())
    .then(function(jsonRes) {
      if (jsonRes.response_code != 0)
      {
        console.log("Error");
      }
      else 
      {
        playButton.style.display = "none";
        answerButton.style.display = "block";

        questions = jsonRes.results;
        currentQuestionIndex = 0;

        DisplayCurrentQuestion(currentQuestionIndex);
      }
    });
}

playButton.onclick = function() {
  ResetGame();
};

answerButton.onclick = function() {
  var answer = document.querySelector("input[name='answer']:checked").value;
  if (answer == questions[currentQuestionIndex].correct_answer)
  {
    correctAnswers += 1;
    correctDiv.innerText = "Correct: " + correctAnswers;
  }

  remainingDiv.innerText = "Remain: " + (NumberOfQuestions - (currentQuestionIndex + 1));
  currentQuestionIndex += 1;

  if (currentQuestionIndex == NumberOfQuestions)
  {
    answerButton.style.display = "none";
    playButton.style.display = "block";
  }
  else 
  {
    DisplayCurrentQuestion();
  }
};